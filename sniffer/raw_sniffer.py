import socket
import struct

snif = socket.socket(socket.AF_PACKET, socket.SOCK_RAW, socket.ntohs(3))
#snif.bind(('',0))
snif_recb = snif.recvfrom(90000)

while True:

    snif_recb_traduzido = struct.unpack('!BBHHHBBH4s4s', snif_recb[0][0:20])

    print("From:", snif_recb[1][0])
    print("Pacote:", snif_recb_traduzido)
    print("IP Verision: ", snif_recb_traduzido[0] >> 4)
    print("TTL: ", snif_recb_traduzido[5])
    print("Protocol: ", snif_recb_traduzido[6])
    print("Source IP:", socket.inet_ntoa(snif_recb_traduzido[8]))
    print("Target IP: ", socket.inet_ntoa(snif_recb_traduzido[9]))

    print(snif_recb[0][20:])